# “数独乐乐”项目软件工程化说明文档

## 引言

- 本文档旨在详细阐述“数独乐乐”项目在软件开发过程中所采用的软件工程化手段。通过**规范化**的指引、**流程化**的管理、**自动化**的工具以及**协作化**的平台，本项目致力于提升开发效率、保障代码质量、促进团队协作，并最终实现一个高质量、易于维护和扩展的软件产品。
- 本文档的目的是：
  - **统一规范：** 为本团队成员提供一套共同遵守的开发标准和流程。
  - **提升效率：** 通过自动化手段减少重复性劳动，加速开发、测试和部署流程。
  - **保证质量：** 将质量内建于开发过程的每个环节，实现持续交付高质量的软件。
  - **知识沉淀：** 方便新成员快速上手，降低团队人员流动带来的影响。
- 工程化核心理念：
  - **自动化一切可自动化之事 (Automate Everything Possible):** 从代码集成到部署监控，最大限度地利用工具解放人力。
  - **代码即一切 (Everything as Code):** 包括基础设施（IaC）、流水线（Pipeline as Code）和配置，皆通过代码进行版本管理。
  - **持续交付 (Continuous Delivery):** 保证代码库在任何时候都处于可发布状态。
  - **快速反馈 (Fast Feedback):** 尽早发现问题，无论是通过自动化测试还是代码审查。
  - **开发者自建自运 (You Build It, You Run It):** 鼓励开发者对自己交付的功能负责到底，包括线上监控和故障排查。
## 1. 规范化 (Standardization)

“数独乐乐”项目在多个层面上遵循了软件工程的规范化原则，通过制定统一的标准来确保代码、文档和流程的一致性、可读性和可维护性。

* **设计原则**：项目在架构设计上遵循了面向对象的设计原则。在《架构设计报告》中明确了对单一职责原则（SRP）、开放/封闭原则（OCP）和依赖倒置原则（DIP）的应用，确保了系统的高内聚、低耦合。
* **编码规范**：项目采用了 **Tailwind CSS** 框架，并通过共享的 `tailwind.config.js` 文件进行统一配置，确保了前端样式的统一和规范。所有开发成员共享 `babel.config.js`、`jest.config.js` 等配置文件，保证了编码环境的一致性。
* **文档结构**：项目建立了清晰、统一的文档体系。所有核心阶段都有对应的规范文档，如《需求分析报告》、《系统建模报告》、《架构设计报告》等，为团队成员提供了统一的设计和开发参照。
* **提交与评审规范**：
    * **提交规范**：团队遵循 **Conventional Commits** 规范，如 `ci(deploy): Update deployment step in GitHub Actions workflow`，使得提交历史清晰、易于追溯，并为自动化生成变更日志提供了基础。
    * **评审流程**：借鉴开源社区实践，所有代码**合并请求（Pull Request）**都需要经过**代码审查（Code Review）**。团队成员及社区贡献者可以对提交的代码进行评论和讨论，确保合并到主干的代码符合质量要求。

## 2. 流程化 (Process-oriented)

项目定义了从需求到维护的完整软件生命周期流程，确保各个阶段有序衔接、持续改进。

* **需求阶段**：流程始于《需求分析报告》的撰写，明确了项目目标、功能及非功能性需求。同时，借鉴群体化开发思想，鼓励社区成员通过 **Issue** 的方式持续提出新的需求创意和功能增强建议。
* **设计与开发阶段**：
    * 依据《系统建模报告》中的 **UML 图** 和《架构设计报告》中的分层设计进行开发。
    * 开发流程遵循基于 **Git** 的**分布式协同开发模式**。开发者首先 **Fork** 原始仓库，再 **Clone** 到本地创建自己的开发分支进行编码。这种方式保证了开发过程的并行和独立性。
* **测试与集成阶段**：
    * 开发者在本地完成功能开发后，需运行 **Jest** 单元测试，确保代码质量。
    * 通过发起 **Pull Request (PR)** 将代码提交进行合并。PR 会触发**自动化测试**和**代码静态分析**（如 CodeQL），只有通过所有检查的代码才能被审查。
    * 核心开发者对通过自动化检查的 PR 进行人工审查，最终将高质量的代码合并（**Merge**）到 `develop` 开发分支。
* **发布与部署阶段**：
    * 当 `develop` 分支的代码达到一个稳定状态时，核心开发者会将其合并到 `master` 主分支。
    * 代码一旦合并到 `master` 分支，将自动触发 **GitHub Actions** 的部署工作流，将应用发布到线上环境，实现**持续部署**。
* **维护阶段**：
    * 线上版本的缺陷和用户反馈通过 **GitHub Issues** 进行跟踪和管理。任何人都可以提交 **Issue** 来报告问题。
    * 社区对 **Issue** 进行讨论、分类和指派，形成新的开发任务，从而进入下一轮的开发迭代，构成一个持续改进的闭环。

## 3. 自动化 (Automation)

“数独乐乐”项目在多个层面采用了自动化工具和流程，以减少重复性劳动，提高开发效率和质量。

### 3.1 自动化构建与部署

项目利用 **GitHub Actions** 实现了持续集成与持续部署 (CI/CD) 的自动化流程。

* **自动化构建**:
    * 项目配置了 `rollup.config.js` 文件，使用 **Rollup.js** 作为模块打包工具。开发者在本地环境中，可以通过在 `package.json` 中定义的 `npm run build` 和 `npm run dev` 命令，实现开发和生产环境的自动化构建。
    * 在 `rollup.config.js` 中，通过 `sveltePreprocess` 和相关插件，实现了 **Svelte** 组件的预处理、**PostCSS** 的编译以及 **Tailwind CSS** 的集成。
    * 生产环境的构建会自动进行代码压缩和优化，例如通过 `terser` 插件对 JavaScript 代码进行压缩。

* **自动化部署**:
    * 在 `.github/workflows/deploy.yml` 文件中定义了自动部署到 **GitHub Pages** 的工作流。
    * 该工作流会在代码推送到 `main` 分支时自动触发，执行构建过程，并将构建产物（`dist` 目录下的静态文件）部署到 **GitHub Pages**，实现了从代码提交到线上部署的全自动化。

### 3.2 自动化测试

项目引入了 **Jest** 测试框架，以实现自动化单元测试，保障代码质量和功能的稳定性。

* **测试配置**:
    * `jest.config.js` 文件详细配置了测试环境（`jsdom`），测试文件的匹配规则 (`**/__tests__/**/*.test.[jt]s?(x)`)，以及代码覆盖率的阈值（要求全局分支、函数、代码行、语句的覆盖率均不低于70%）。
    * 通过 `transform` 配置，使得 Jest 能够处理 **Svelte** (`.svelte`) 和 **JavaScript** (`.js`) 文件，并使用 `babel-jest` 和 `svelte-jester` 进行代码转换。

* **测试用例**:
    * 项目的 `__tests__/unit/` 目录下存放了针对各个核心功能的单元测试文件，例如 `undoRedo.test.js`, `backtracking.test.js`, `importSudoku.test.js`, 和 `possibleNumber.test.js`。
    * 这些测试用例覆盖了撤销/重做、回溯算法、URL导入数独、候选数计算等关键功能，确保了这些模块的正确性和健壮性。

### 3.3 自动化代码分析

为了在早期发现代码中的潜在问题，项目集成了 **CodeQL** 进行自动化的静态代码分析。

* **静态分析流程**:
    * 在 `.github/workflows/codeql-analysis.yml` 文件中定义了 CodeQL 的分析工作流。
    * 该工作流会在代码推送到 `main` 分支或创建拉取请求 (Pull Request) 时自动触发，对项目中的 JavaScript 代码进行扫描，以发现潜在的安全漏洞、bug 和代码风格问题。
    * 这有助于在代码合并到主分支之前，及时发现并修复问题，提高了代码的整体质量和安全性。

## 4. 协作化 (Collaboration)

“数独乐乐”项目借助现代化的协作平台和工具，为团队内部成员和外部社区贡献者提供了高效的协作环境。

* **代码托管与版本控制**:
    * 项目使用 **Git** 进行分布式版本控制，并以 **GitHub** 作为中心化的代码托管平台。这为所有开发者提供了一个共享、透明的代码仓库。
    * 通过 **Pull Request (PR)** 机制，规范了代码贡献的流程，使得代码审查、讨论和合并都在线上透明地进行。

* **任务管理与跟踪**:
    * 项目利用 **GitHub Issues** 作为任务管理的核心工具。无论是缺陷报告、功能需求还是技术讨论，都可以通过 Issue 发起和跟踪。
    * 任何人都可以创建、评论、讨论 Issue，充分体现了群体化开发的开放性。核心开发者则可以通过标签（Labels）、负责人（Assignees）、里程碑（Milestones）等功能对任务进行系统化管理。

* **文档与知识协作**:
    * 项目的所有文档，包括需求、设计、开发日志等，都以 Markdown 文件的形式存放在代码仓库中，与代码一同进行版本管理，方便团队成员协作编辑和审阅。
    * 未来，项目计划利用 **GitHub Wiki** 和 **Discussions** 等功能，或借鉴 **Stack Overflow** 等平台的模式，建立一个开放的知识分享社区，让群体智慧在解决问题和知识沉淀中发挥更大作用。

